if('serviceWorker'in navigator){var subscriptionId;navigator.serviceWorker.register(link.global+'service-worker.js').then(function(reg){navigator.serviceWorker.ready.then(function(serviceWorkerRegistration){return serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:true});}).then(function(subscription){subscriptionId=subscription.endpoint.split('/');subscriptionId=subscriptionId[subscriptionId.length- 1];$.post(link.action+'update_registration_ids.php',{registration_ids:subscriptionId},function(data){},'json');}).catch(function(subscriptionErr){});}).catch(function(error){});}