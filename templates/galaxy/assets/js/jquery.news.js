$(function(){if(userOnline){$(document).on('click','.content > .bottom > .newlike',function(){var tthis=$(this),type=(tthis.hasClass('ilike'))?'like':'dislike',postid=tthis.attr('id'),bazhtml=tthis.clone(),tthisimg=$('> img',tthis).clone();if(type=='like'){tthis.removeClass('ilike');}else{tthis.addClass('ilike');}
$.post(link.action+'news_likegestion.php',{type:type,postid:postid},function(data){if(data.type=='error'){tthis.replaceWith(bazhtml)
$.error.top(data,{'scroll':'top'});}else{tthis.html(data.message);tthisimg.prependTo(tthis);if(data.number<1){tthis.removeAttr('tooltip');$('.tooltip').remove();}else{if(!tthis.attr('tooltip')){tthis.attr('tooltip',true);}}
tthis.attr('totalikes',data.number);}},'json');});$(document).on('click','form[name="del_com"]',function(){var tthis=$(this),action=link.action+ tthis.attr('action'),commentid=$('> input[name="commentid"]',tthis).val(),articleid=$('> input[name="articleid"]',tthis).val(),commentBox=$('.MSG.intern[id="'+ commentid+'"]');commentBox.fadeOut(0);$.post(action,{commentid:commentid,articleid:articleid},function(data){if(data.type=='error'){if($('.error.msgbox').length<1){$('.content.comments').prepend('<div class="error msgbox">'+ data.message+'</div>');}else{$('.msgbox').animate({'padding-bottom':'+=10px'},200).text(data.message).animate({'padding-bottom':'-=10px'});}
commentBox.fadeIn(0);}else{$('.msgbox').remove();commentBox.remove();if($('.MSG.intern').length<1){$('.content.comments').append('<div class="error msgbox">Aucun commentaire pour le moment, sois le premier Ã  commenter !</div>');}}},'json');return false;});$(document).on('click','.content > .widget-teams > .team',function(){var tthis=$(this),teamid=tthis.attr("data-id");$.post(link.action+'news_team.php',{teamid:teamid},function(data){if(data.type=='error'){$.error.top(data,{'scroll':'top'});}else{$.error.top(data,{'scroll':'top'});$('.team[data-id="1"] > b').html(data.number.teamA);$('.team[data-id="2"] > b').html(data.number.teamB);}},'json');});}
$('.share').share({customUrl:link.actuel,texte:"Partager l'article"});$('.content > .bottom > .newlike').each(function(index){var tthis=$('.content > .bottom > .newlike').eq(index);tthis.attr('tooltip-direction','top').attr('tooltip-content','Chargement');if(tthis.attr('totalikes')>0){tthis.attr('tooltip',true);}});$(document).on('mouseover','.content > .bottom > .newlike',function(){var id=$(this).attr('id'),tthis=$(this),totalikes=parseInt($(this).attr('totalikes')),left;if(totalikes>0){$.get(link.action+'news_get_likes.php',{id:id},function(data){if(data.type=='error'){tthis.attr('tooltip-content',data.message);}else{var users=data.users.toString().split(','),usersList='',userListHeightPlus=0;for(var i=0;i<users.length;i++){usersList+='<p>'+ users[i]+'</p>';if(i>0){userListHeightPlus=userListHeightPlus+ 14;}}
$('.tooltip').html(usersList).animate({top:(parseInt($('.tooltip').offset().top)- userListHeightPlus)+'px',left:(parseInt(tthis.offset().left)-(parseInt($('.tooltip').css('width'))/ 2) + parseInt(tthis.css('width')) / 2) + 'px'},0);}},'json');}});});