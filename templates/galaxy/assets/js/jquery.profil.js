$(function(){var candragfriends=true;if($('.rightfriends > .open').length<4){candragfriends=false;}
if(candragfriends){$('.rightfriends').draggable({axis:'x',drag:function(e,ui){var left=ui.position.left,open=$('.rightfriends > .open'),ftotalwidth=null,width,maxright;open.each(function(index){ftotalwidth+=$(this).width();if(index<open.length- 1){ftotalwidth+=10;}});maxright=$('.rightfriends').width()- ftotalwidth;if(left>0){ui.position.left=0;}else if(left<maxright){ui.position.left=maxright;}}});}else{$('.rightfriends').removeClass('candrag');console.log('Action impossible.');}
var bulle=$('.bulles > .bubule'),time=4000,intervalNews=setTimeout(function(){slidernews();},time),newid,nc;function slidernews(nc,clicked){clearInterval(intervalNews);if(!clicked){bulle.each(function(index){if($(this).hasClass('slc')){nc=parseInt($(this).attr('toid'))+ 1;}});}
if(nc>=bulle.length){nc=0;}else if(nc<0){nc=bulle.length;}
$('.bulles > .bubule').removeClass('slc');$('.bulles > .bubule[toid="'+ nc+'"]').addClass('slc');$('.news > .article').fadeOut(0);$('.news > .article[id="'+ nc+'"]').fadeIn(0);nc++;intervalNews=setTimeout(function(){slidernews(nc);},time);}
setTimeout(function(){intervalNews;},time);$('.bulles > .bubule').on('click',function(){var id=$(this).attr('toid');slidernews(id,true);});var radioURL="https://moveradio2.ice.infomaniak.ch/moveradio.mp3";$('.radio').append('<audio preload="auto" controls>Votre navigateur ne supporte pas l\'élément <code>audio</code>.</audio>');$(document).on('click','.radio > .controls > .start',function(){if($('.radio > .controls > .start').hasClass('started')){$('.radio > audio').get(0).pause();$('.radio > audio').get(0).currentTime=0;$('.radio > audio').get(0).src='';$('.radio > .controls > .start').removeClass('started');editRadioSetting({'type':'enabled','value':'0'});}else{$('.radio > audio').attr('volume',radio.volume);$('.radio > audio').prop('volume',radio.volume);$('.radio > audio').get(0).src=radioURL;$('.radio > audio').get(0).play();$('.radio > .controls > .start').addClass('started');editRadioSetting({'type':'enabled','value':'1'});}});if(radio.enabled=='1'){$('.radio > .controls > .start').click();}
$('.radio > .controls > .volume > .bar').css('width','calc('+ radio.volume.replace('0.','')+'% - 32px)');$(document).on('click','.radio > .controls > .volume',function(e){var position=e.pageX- $('.radio > .controls > .volume').offset().left
percentage=100*position/$('.radio > .controls > .volume').width(),volume=Math.round(percentage).toFixed(2)/ 100;radio.volume=volume;$('.radio > .controls > .volume > .bar').css('width','calc('+ percentage+'% - 32px)');$('.radio > audio').prop('volume',volume);editRadioSetting({'type':'volume','value':volume});});$(document).on('click','.radio > .controls > .volume > .off',function(e){e.stopPropagation();$('.radio > .controls > .volume > .bar').css('width','calc(0% - 32px)');$('.radio > audio').prop('volume','0.0');editRadioSetting({'type':'volume','value':'0'});});$(document).on('click','.followUser',function(){var userid=$(this).attr('user-id'),action=link.action+'follow_user.php';$.get(action,{userid:userid},function(data){$.error.top(data,{'scroll':'top'});setInterval(function(){$.error.remove();},8000);},'json');});function editRadioSetting(values){$.post(link.action+'radio_settings.php',values,function(data){if(data.type=='error'){$.error.top(data,{'scroll':'top'});}else{$.error.remove();}},'json')}});